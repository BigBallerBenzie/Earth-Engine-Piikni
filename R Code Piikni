library(rayshader)
library(sp)
library(raster)
library(scales)
library(rgdal)
memory.limit(size = 10000000)

elevation1= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W103.hgt")
elevation2= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W104.hgt")
elevation3= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W105.hgt")
elevation4= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W106.hgt")
elevation5= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W107.hgt")
elevation6= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W108.hgt")
elevation7= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W109.hgt")
elevation8= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W110.hgt")
elevation9= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W111.hgt")
elevation10= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W112.hgt")
elevation11= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W113.hgt")
elevation12= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W114.hgt")
elevation13= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W115.hgt")
elevation14= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W116.hgt")
elevation15= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W117.hgt")
elevation16= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W118.hgt")
elevation17= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W119.hgt")
elevation18= raster::raster("C:/Users/jacob/OneDrive/Desktop/N44W120.hgt")
elevation19= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W103.hgt")
elevation20= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W104.hgt")
elevation21= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W105.hgt")
elevation22= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W106.hgt")
elevation23= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W107.hgt")
elevation24= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W108.hgt")
elevation25= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W109.hgt")
elevation26= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W110.hgt")
elevation27= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W111.hgt")
elevation28= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W112.hgt")
elevation29= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W113.hgt")
elevation30= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W114.hgt")
elevation31= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W115.hgt")
elevation32= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W116.hgt")
elevation33= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W117.hgt")
elevation34= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W118.hgt")
elevation35= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W119.hgt")
elevation36= raster::raster("C:/Users/jacob/OneDrive/Desktop/N45W120.hgt")
elevation37= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W103.hgt")
elevation38= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W104.hgt")
elevation39= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W105.hgt")
elevation40= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W106.hgt")
elevation41= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W107.hgt")
elevation42= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W108.hgt")
elevation43= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W109.hgt")
elevation44= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W110.hgt")
elevation45= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W111.hgt")
elevation46= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W112.hgt")
elevation47= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W113.hgt")
elevation48= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W114.hgt")
elevation49= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W115.hgt")
elevation50= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W116.hgt")
elevation51= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W117.hgt")
elevation52= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W118.hgt")
elevation53= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W119.hgt")
elevation54= raster::raster("C:/Users/jacob/OneDrive/Desktop/N46W120.hgt")
elevation55= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W103.hgt")
elevation56= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W104.hgt")
elevation57= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W105.hgt")
elevation58= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W106.hgt")
elevation59= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W107.hgt")
elevation60= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W108.hgt")
elevation61= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W109.hgt")
elevation62= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W110.hgt")
elevation63= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W111.hgt")
elevation64= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W112.hgt")
elevation65= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W113.hgt")
elevation66= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W114.hgt")
elevation67= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W115.hgt")
elevation68= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W116.hgt")
elevation69= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W117.hgt")
elevation70= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W118.hgt")
elevation71= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W119.hgt")
elevation72= raster::raster("C:/Users/jacob/OneDrive/Desktop/N47W120.hgt")
elevation73= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W103.hgt")
elevation74= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W104.hgt")
elevation75= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W105.hgt")
elevation76= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W106.hgt")
elevation77= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W107.hgt")
elevation78= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W108.hgt")
elevation79= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W109.hgt")
elevation80= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W110.hgt")
elevation81= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W111.hgt")
elevation82= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W112.hgt")
elevation83= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W113.hgt")
elevation84= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W114.hgt")
elevation85= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W115.hgt")
elevation86= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W116.hgt")
elevation87= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W117.hgt")
elevation88= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W118.hgt")
elevation89= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W119.hgt")
elevation90= raster::raster("C:/Users/jacob/OneDrive/Desktop/N48W120.hgt")
elevation91= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W103.hgt")
elevation92= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W104.hgt")
elevation93= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W105.hgt")
elevation94= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W106.hgt")
elevation95= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W107.hgt")
elevation96= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W108.hgt")
elevation97= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W109.hgt")
elevation98= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W110.hgt")
elevation99= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W111.hgt")
elevation100= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W112.hgt")
elevation101= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W113.hgt")
elevation102= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W114.hgt")
elevation103= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W115.hgt")
elevation104= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W116.hgt")
elevation105= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W117.hgt")
elevation106= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W118.hgt")
elevation107= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W119.hgt")
elevation108= raster::raster("C:/Users/jacob/OneDrive/Desktop/N49W120.hgt")
elevation109= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W103.hgt")
elevation110= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W104.hgt")
elevation111= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W105.hgt")
elevation112= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W106.hgt")
elevation113= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W107.hgt")
elevation114= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W108.hgt")
elevation115= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W109.hgt")
elevation116= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W110.hgt")
elevation117= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W111.hgt")
elevation118= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W112.hgt")
elevation119= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W113.hgt")
elevation120= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W114.hgt")
elevation121= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W115.hgt")
elevation122= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W116.hgt")
elevation123= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W117.hgt")
elevation124= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W118.hgt")
elevation125= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W119.hgt")
elevation126= raster::raster("C:/Users/jacob/OneDrive/Desktop/N50W120.hgt")
elevation127= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W103.hgt")
elevation128= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W104.hgt")
elevation129= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W105.hgt")
elevation130= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W106.hgt")
elevation131= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W107.hgt")
elevation132= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W108.hgt")
elevation133= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W109.hgt")
elevation134= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W110.hgt")
elevation135= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W111.hgt")
elevation136= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W112.hgt")
elevation137= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W113.hgt")
elevation138= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W114.hgt")
elevation139= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W115.hgt")
elevation140= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W116.hgt")
elevation141= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W117.hgt")
elevation142= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W118.hgt")
elevation143= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W119.hgt")
elevation144= raster::raster("C:/Users/jacob/OneDrive/Desktop/N51W120.hgt")
piik_elevation = raster::merge(elevation1,elevation2,elevation3,elevation4,elevation5,elevation6,elevation7,elevation8,elevation9,elevation10,elevation11,elevation12,elevation13,elevation14,elevation15,elevation16,elevation17,elevation18,elevation19,elevation20,elevation21,elevation22,elevation23,elevation24,elevation25,elevation26,elevation27,elevation28,elevation29,elevation30,elevation31,elevation32,elevation33,elevation34,elevation35,elevation36,elevation37,elevation38,elevation39,elevation40,elevation41,elevation42,elevation43,elevation44,elevation45,elevation46,elevation47,elevation48,elevation49,elevation50,elevation51,elevation52,elevation53,elevation54,elevation55,elevation56,elevation57,elevation58,elevation59,elevation60,elevation61,elevation62,elevation63,elevation64,elevation65,elevation66,elevation67,elevation68,elevation69,elevation70,elevation71,elevation72,elevation73,elevation74,elevation75,elevation76,elevation77,elevation78,elevation79,elevation80,elevation81,elevation82,elevation83,elevation84,elevation85,elevation86,elevation87,elevation88,elevation89,elevation90,elevation91,elevation92,elevation93,elevation94,elevation95,elevation96,elevation97,elevation98,elevation99,elevation100,elevation101,elevation102,elevation103,elevation104,elevation105,elevation106,elevation107,elevation108,elevation109,elevation110,elevation111,elevation112,elevation113,elevation114,elevation115,elevation116,elevation117,elevation118,elevation119,elevation120,elevation121,elevation122,elevation123,elevation124,elevation125,elevation126,elevation127,elevation128,elevation129,elevation130,elevation131,elevation132,elevation133,elevation134,elevation135,elevation136,elevation137,elevation138,elevation139,elevation140,elevation141,elevation142,elevation143,elevation144)

height_shade(raster_to_matrix(piik_elevation)) %>%
  plot_map()

piik_r = raster::raster("C:/Users/jacob/OneDrive/Desktop/Merged_piikni_b4.TIF")
piik_g = raster::raster("C:/Users/jacob/OneDrive/Desktop/Merged_piikni_b3.TIF")
piik_b = raster::raster("C:/Users/jacob/OneDrive/Desktop/Merged_piikni_b2.TIF")

piik_rgb = raster::stack(piik_r, piik_g, piik_b)
raster::plotRGB(piik_rgb, scale=255^2)

piik_rgb_corrected = sqrt(raster::stack(piik_r, piik_g, piik_b))
raster::plotRGB(piik_rgb_corrected)

raster::crs(piik_r)
raster::crs(piik_elevation)
crs(piik_r)
piik_elevation_utm = raster::projectRaster(piik_elevation, crs = crs(piik_r), method = "bilinear")
crs(piik_elevation_utm)
bottom_left = c(y=-115.339701,x= 45.607201)
top_right   = c(y=-105.472301,x= 49.891401)

extent_latlong = sp::SpatialPoints(rbind(bottom_left, top_right), proj4string=sp::CRS("+proj=longlat +ellps=WGS84 +datum=WGS84"))
extent_utm = sp::spTransform(extent_latlong, raster::crs(piik_elevation_utm))

e = raster::extent(extent_utm)
e
piik_rgb_cropped = raster::crop(piik_rgb_corrected, e)
elevation_cropped = raster::crop(piik_elevation_utm, e)

names(piik_rgb_cropped) = c("r","g","b")

piik_r_cropped = rayshader::raster_to_matrix(piik_rgb_cropped$r)
piik_g_cropped = rayshader::raster_to_matrix(piik_rgb_cropped$g)
piik_b_cropped = rayshader::raster_to_matrix(piik_rgb_cropped$b)

piikel_matrix = rayshader::raster_to_matrix(elevation_cropped)

piik_rgb_array = array(0,dim=c(nrow(piik_r_cropped),ncol(piik_r_cropped),3))

piik_rgb_array[,,1] = piik_r_cropped/255 #Red layer
piik_rgb_array[,,2] = piik_g_cropped/255 #Blue layer
piik_rgb_array[,,3] = piik_b_cropped/255 #Green layer

piik_rgb_array = aperm(piik_rgb_array, c(2,1,3))
plot_map(piik_rgb_array)

plot_3d(piik_rgb_array, piikel_matrix, windowsize = c(1100,900), zscale = 15, shadowdepth = -50,
        zoom=0.5, phi=45,theta=-45,fov=70, background = "#F2E1D0", shadowcolor = "#523E2B")
render_snapshot(title_text = "West Maui Forest Reserve, Hawaii | Imagery: Landsat 8 | DEM: 30m SRTM",
                title_bar_color = "#1f5214", title_color = "white", title_bar_alpha
